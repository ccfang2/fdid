<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>fdid • fdid</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/Inter-0.4.9/font.css" rel="stylesheet">
<link href="deps/Fira_Code-0.4.9/font.css" rel="stylesheet">
<link href="deps/Merriweather-0.4.9/font.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="fdid">
<meta name="description" content="Functional Difference-in-Differences tools for honest inference with event study plots.
">
<meta property="og:description" content="Functional Difference-in-Differences tools for honest inference with event study plots.
">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">fdid</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="index.html">Home</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ccfang2/fdid"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="fdid-">fdid <img src="reference/figures/fdid_badge.png" align="right" alt="" width="155"><a class="anchor" aria-label="anchor" href="#fdid-"></a>
</h1></div>
<p><a href="https://makeapullrequest.com" class="external-link"><img src="https://img.shields.io/badge/PRs-welcome-brightgreen.svg?style=flat-square" alt="PRs Welcome"></a> <img src="https://img.shields.io/github/last-commit/ccfang2/fdid?logo=GitHub" alt="GitHub last commit"><img src="https://img.shields.io/github/repo-size/ccfang2/fdid?logo=GitHub" alt="GitHub repo size"><img src="https://img.shields.io/github/r-package/v/ccfang2/fdid?logo=R" alt="GitHub R package version"><img src="https://img.shields.io/github/stars/ccfang2/fdid?style=social" alt="GitHub Repo stars"></p>
<blockquote>
<p>The R package <code>fdid</code> allows users to implement the method proposed in Fang and Liebl (2025)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Fang, C. and Liebl, D. (2025). Making Event Study Plots Honest: A Functional Data Approach to Causal Inference. Working Paper&lt;/p&gt;"><sup>1</sup></a>. In this paper, we present a novel functional perspective on Difference-in-Differences (DiD) that allows for honest inference using event study plots under violations of parallel trends and/or no-anticipation assumptions. We use the algorithm of so-called fast and fair simultaneous confidence band from Liebl and Reimherr (2023)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Liebl, D. and M. Reimherr (2023). Fast and fair simultaneous confidence bands for functional parameters. Journal of the Royal Statistical Society Series B: Statistical Methodology 85(3), 842–868&lt;/p&gt;"><sup>2</sup></a> to construct the simultaneous confidence band in our plots.</p>
</blockquote>
<blockquote>
<p>We turn traditional event study plots into rigorous honest causal inference tools through equivalence and relevance testing: Honest reference bands can be validated using equivalence testing in the pre-treatment period, and honest causal effects can be tested using relevance testing in the post-treatment period.</p>
</blockquote>
<blockquote>
<p>You may find a presentation of an early version of the paper in my YouTube <a href="https://www.youtube.com/watch?v=h0KCv8y9Apw" class="external-link">video</a>. Also, users can adjust their honest reference bands (see below) interactively via our <a href="https://ccfang2.shinyapps.io/fdidHonestInference/" class="external-link">Shiny app</a>.</p>
</blockquote>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of <code>fdid</code> from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"ccfang2/fdid"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-1-classical-simultaneous-causal-inference">Example 1: Classical Simultaneous Causal Inference<a class="anchor" aria-label="anchor" href="#example-1-classical-simultaneous-causal-inference"></a>
</h2>
<p>We hereby use event study estimates from Gallagher (2014)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Gallagher, J. (2014). Learning about an Infrequent Event: Evidence from Flood Insurance Take-Up in the United States. American Economic Journal: Applied Economics 6(3), 206–33.&lt;/p&gt;"><sup>3</sup></a> as an example.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">fdid</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Gdata</span><span class="op">)</span></span>
<span><span class="va">fdid_scb_est</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fdid_scb.html">fdid_scb</a></span><span class="op">(</span>beta<span class="op">=</span><span class="va">Gdata</span><span class="op">$</span><span class="va">beta</span>, cov<span class="op">=</span><span class="va">Gdata</span><span class="op">$</span><span class="va">cov</span>, t0<span class="op">=</span><span class="va">Gdata</span><span class="op">$</span><span class="va">t0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fdid_scb_est</span>, pos.legend<span class="op">=</span><span class="st">"bottom"</span>, scale.legend<span class="op">=</span><span class="fl">1.4</span><span class="op">)</span></span></code></pre></div>
<p>We first load the data from our package, and then we use the function <code><a href="reference/fdid_scb.html">fdid_scb()</a></code> to compute simultaneous confidence band from using the estimates of event study coefficients, covariances and reference time point, and finally we use the generic function <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> to derive a figure as follows.</p>
<p align="center">
<img src="reference/figures/plot_scb.png" width="50%"></p>
<p>As is seen, the reference time in this example is at event time -1. The gray area indicates the time span over which the treatment effect is uniformly significant under our simultaneous confidence band. Traditional confidence intervals are also plotted. The intervals fail to take into account the multiple testing problem, so they are typically narrower than our band.</p>
<p>If you do not have estimates of event study coefficients and covariances, you may use our function <code><a href="reference/fdid.html">fdid()</a></code> to estimate them from using your original data. Our function allows the estimation under both non-staggered and staggered DiD designs. In particularly, we consider the negative weighting problem of estimating event study coefficients under staggered designs and use carefully chosen non-negative weights to sum up estimates from different treatment subgroups.</p>
</div>
<div class="section level2">
<h2 id="example-2-honest-causal-inference-under-treatment-anticipation-with-reference-band">Example 2: Honest Causal Inference under Treatment Anticipation with Reference Band<a class="anchor" aria-label="anchor" href="#example-2-honest-causal-inference-under-treatment-anticipation-with-reference-band"></a>
</h2>
<p>Following Example 1, we now suppose that, after event time <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>A</mi></msub><mo>=</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">t_A=-1</annotation></semantics></math>, there is an anticipation of treatment. We use <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>S</mi></msub><mo>=</mo><mo>−</mo><mn>9</mn><mo>&lt;</mo><msub><mi>t</mi><mi>A</mi></msub></mrow><annotation encoding="application/x-tex">t_S=-9 &lt; t_A</annotation></semantics></math> to compute the sample estimates for the reference band.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fdid_scb_est</span>, ta.ts<span class="op">=</span><span class="op">-</span><span class="fl">9</span>, ta.s<span class="op">=</span><span class="fl">2.6</span>, pos.legend<span class="op">=</span><span class="st">"bottom"</span>, scale.legend<span class="op">=</span><span class="fl">1.4</span><span class="op">)</span></span></code></pre></div>
<p align="center">
<img src="reference/figures/plot_scb_ta.png" width="50%"></p>
<p>With an anticipation after event time -1, one may see the time span over which the treatment effect is uniformly significant shrinks. With the control parameter <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mn>2.6</mn></mrow><annotation encoding="application/x-tex">S=2.6</annotation></semantics></math>, the reference band can be validated at significance level 5%, since the simultaneous confidence band strictly lies within the reference band in the pre-treatment period.</p>
</div>
<div class="section level2">
<h2 id="example-3-honest-causal-inference-under-differential-trends-with-relative-magnitudes-reference-band">Example 3: Honest Causal Inference under Differential Trends with Relative Magnitudes Reference Band<a class="anchor" aria-label="anchor" href="#example-3-honest-causal-inference-under-differential-trends-with-relative-magnitudes-reference-band"></a>
</h2>
<p>Following Example 1, we now suppose that, there is differential trend of relative magnitudes with control parameter <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>M</mi><mo accent="true">¯</mo></mover><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\overline{M}=1</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fdid_scb_est</span>, frm.mbar<span class="op">=</span><span class="fl">1</span>, pos.legend<span class="op">=</span><span class="st">"bottom"</span>, scale.legend<span class="op">=</span><span class="fl">1.4</span><span class="op">)</span></span></code></pre></div>
<p align="center">
<img src="reference/figures/plot_scb_frm.png" width="50%"></p>
<p>Under such a differential trend, the time span over which the treatment effect is uniformly significant is also smaller. It can be seen that the average absolute derivative of functional DiD estimate over pre-treatment time is quite large, so our reference band for honest inference is also wide.</p>
</div>
<div class="section level2">
<h2 id="example-4-honest-inference-under-differential-trends-with-trend-restrictions-reference-band">Example 4: Honest Inference under Differential Trends with Trend Restrictions Reference Band<a class="anchor" aria-label="anchor" href="#example-4-honest-inference-under-differential-trends-with-trend-restrictions-reference-band"></a>
</h2>
<p>Following Example 1, we now suppose that, there is differential trend of trend restrictions with control parameter <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">M=2</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fdid_scb_est</span>, ftr.m<span class="op">=</span><span class="fl">2</span>, pos.legend<span class="op">=</span><span class="st">"bottom"</span>, scale.legend<span class="op">=</span><span class="fl">1.4</span><span class="op">)</span></span></code></pre></div>
<p align="center">
<img src="reference/figures/plot_scb_ftr.png" width="50%"></p>
<p>With this specific differential trend, the time span over which the treatment effect is uniformly significant is not so different from that without. It can be seen that the pre-trend, measured by the average of derivative of functional DiD estimate over pre-treatment time, is quite small. Hence, the inference result does not change too much from Example 1, even though the control parameter is not infinitesimal.</p>
</div>
<div class="section level2">
<h2 id="contact">Contact<a class="anchor" aria-label="anchor" href="#contact"></a>
</h2>
<p>Chencheng Fang, Email: <a href="mailto:ccfang@uni-bonn.de">ccfang[at]uni-bonn.de</a>, Institute of Finance and Statistics, University of Bonn</p>
</div>
<div class="section level2">
<h2 id="reference">Reference<a class="anchor" aria-label="anchor" href="#reference"></a>
</h2>
</div>
</div>


  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 3)</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing fdid</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://github.com/ccfang2" class="external-link">Chencheng Fang</a> <br><small class="roles"> Author, maintainer </small>  </li>
<li>Dominik Liebl <br><small class="roles"> Author </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>list(text = “© 2025 Chencheng Fang · University of Bonn”)</p>
</div>

<div class="pkgdown-footer-right">
  <p>list(text = “Built with pkgdown and bslib”)</p>
</div>

    </footer>
</div>





  </body>
</html>
