<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compute Simultaneous Confidence Bands for Event Study Coefficients in Functional DiD Framework — fdid_scb • fdid</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Inter-0.4.9/font.css" rel="stylesheet"><link href="../deps/Fira_Code-0.4.9/font.css" rel="stylesheet"><link href="../deps/Merriweather-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute Simultaneous Confidence Bands for Event Study Coefficients in Functional DiD Framework — fdid_scb"><meta name="description" content="The fdid_scb function is used to compute simultaneous confidence bands for event study coefficients in a functional
framework. Specifically, we compute an infimum-based simultaneous confidence band in pre-treatment period by parametric bootstrap, and a supremum-based
simultaneous confidence band in post-treatment period by the algorithm of Kac-Rice formula proposed in Liebl and Reimherr (2023)."><meta property="og:description" content="The fdid_scb function is used to compute simultaneous confidence bands for event study coefficients in a functional
framework. Specifically, we compute an infimum-based simultaneous confidence band in pre-treatment period by parametric bootstrap, and a supremum-based
simultaneous confidence band in post-treatment period by the algorithm of Kac-Rice formula proposed in Liebl and Reimherr (2023)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fdid</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/ccfang2/fdid"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Compute Simultaneous Confidence Bands for Event Study Coefficients in Functional DiD Framework</h1>

      <div class="d-none name"><code>fdid_scb.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>fdid_scb</code> function is used to compute simultaneous confidence bands for event study coefficients in a functional
framework. Specifically, we compute an infimum-based simultaneous confidence band in pre-treatment period by parametric bootstrap, and a supremum-based
simultaneous confidence band in post-treatment period by the algorithm of Kac-Rice formula proposed in <a href="https://academic.oup.com/jrsssb/article/85/3/842/7133768" class="external-link">Liebl and Reimherr (2023)</a>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fdid_scb</span><span class="op">(</span></span>
<span>  object <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  beta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cov <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  t0 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  df <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ci.alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  scb.pre.alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  scb.post.alpha <span class="op">=</span> <span class="fl">0.05</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>an object of S3 class <code>"fdid"</code>, which is an output of the function <a href="fdid.html">fdid</a>. If it is provided, arguments 'beta',
'cov' and 't0' are ignored.</p></dd>


<dt id="arg-beta">beta<a class="anchor" aria-label="anchor" href="#arg-beta"></a></dt>
<dd><p>a numeric matrix with two columns. The first column is the estimates of event study coefficients and the second column is the
corresponding event time. The estimate of coefficient at reference time should be normalized to 0.</p></dd>


<dt id="arg-cov">cov<a class="anchor" aria-label="anchor" href="#arg-cov"></a></dt>
<dd><p>a numeric matrix of covariance estimates.</p></dd>


<dt id="arg-t-">t0<a class="anchor" aria-label="anchor" href="#arg-t-"></a></dt>
<dd><p>a numeric scalar that indicates the reference time.</p></dd>


<dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p>degree of freedom for the t-distributed based band in post-treatment periods. If NULL, Gaussian distributed bands are computed.</p></dd>


<dt id="arg-ci-alpha">ci.alpha<a class="anchor" aria-label="anchor" href="#arg-ci-alpha"></a></dt>
<dd><p>significance level for the point-wise confidence intervals.</p></dd>


<dt id="arg-scb-pre-alpha">scb.pre.alpha<a class="anchor" aria-label="anchor" href="#arg-scb-pre-alpha"></a></dt>
<dd><p>significance level for the infimum-based simultaneous confidence band in pre-treatment periods.</p></dd>


<dt id="arg-scb-post-alpha">scb.post.alpha<a class="anchor" aria-label="anchor" href="#arg-scb-post-alpha"></a></dt>
<dd><p>significance level for the supremum-based simultaneous confidence band in post-treatment periods.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The <code>fdid_scb</code> function returns a list containing three objects:</p><dl><dt>scb</dt>
<dd><p>a list that includes the functional estimate of event study coefficients and the simultaneous confidence bands.</p></dd>

<dt>ci</dt>
<dd><p>a matrix that includes the point-wise estimates of event study coefficients and their confidence intervals.</p></dd>

<dt>data</dt>
<dd><p>a list that stores the original inputs of beta and cov.</p></dd>


</dl><p>The output is an object of S3 class <code>"fdid_scb"</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Fang, C. and Liebl, D. (2025). Making Event Study Plots Honest: A Functional Data Approach to Causal Inference. <a href="https://arxiv.org/abs/2512.06804" class="external-link">arXiv:2512.06804</a>.</p>
<p>Liebl, D. and M. Reimherr (2023). Fast and fair simultaneous confidence bands for functional parameters. Journal of
the Royal Statistical Society Series B: Statistical Methodology 85(3), 842–868</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="fdid.html">fdid</a>, <a href="https://rdrr.io/pkg/ffscb/man/confidence_band.html" class="external-link">confidence_band</a>, <a href="https://rdrr.io/pkg/ffscb/man/confidence_band_fragm.html" class="external-link">confidence_band_fragm</a>, <a href="cov_spline.html">cov_spline</a></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">LWdata</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fdid_scb_est1</span> <span class="op">&lt;-</span> <span class="fu">fdid_scb</span><span class="op">(</span>beta<span class="op">=</span><span class="va">LWdata</span><span class="op">$</span><span class="va">beta</span>, cov<span class="op">=</span><span class="va">LWdata</span><span class="op">$</span><span class="va">cov</span>, t0<span class="op">=</span><span class="va">LWdata</span><span class="op">$</span><span class="va">t0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">simulated_stagger_example</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fdid_est2</span> <span class="op">&lt;-</span> <span class="fu"><a href="fdid.html">fdid</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">simulated_stagger_data</span>, treatment<span class="op">=</span><span class="va">simulated_stagger_treatment</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fdid_scb_est2</span> <span class="op">&lt;-</span> <span class="fu">fdid_scb</span><span class="op">(</span>object<span class="op">=</span><span class="va">fdid_est2</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>list(text = “© 2025 Chencheng Fang · University of Bonn”)</p>
</div>

<div class="pkgdown-footer-right">
  <p>list(text = “Built with pkgdown and bslib”)</p>
</div>

    </footer></div>





  </body></html>

