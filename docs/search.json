[{"path":"https://ccfang2.github.io/fdid/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Chencheng Fang. Author, maintainer. Dominik Liebl. Author.","code":""},{"path":"https://ccfang2.github.io/fdid/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Fang C, Liebl D (2026). fdid: Making Event Study Plots Honest: Functional Data Approach Causal Inference.. R package version 0.0.1.","code":"@Manual{,   title = {fdid: Making Event Study Plots Honest: A Functional Data Approach to Causal Inference.},   author = {Chencheng Fang and Dominik Liebl},   year = {2026},   note = {R package version 0.0.1}, }"},{"path":[]},{"path":"https://ccfang2.github.io/fdid/index.html","id":"a-functional-data-approach-to-causal-inference-","dir":"","previous_headings":"","what":"A Functional Data Approach to Causal Inference","title":"fdid","text":"R package fdid allows users implement method proposed Fang Liebl (2026)1. paper, present novel functional perspective Difference--Differences () allows honest inference using event study plots violations parallel trends /-anticipation assumptions. Specifically, compute infimum-based simultaneous confidence band pre-treatment period parametric bootstrap, supremum-based simultaneous confidence band post-treatment period algorithm Kac-Rice formula proposed Liebl Reimherr (2023)2. Additionally, contrast classical reference line traditional event study plots, derive honest reference band, accounting potential biases violation parallel trends -anticipation assumption, making inference. , turn traditional event study plots rigorous honest causal inference tools equivalence relevance testing: Honest reference band can validated via equivalence testing pre-anticipation period, honest causal effects can tested relevance testing using honest reference band post-treatment period. may find presentation early version paper YouTube video. Also, users can adjust honest reference bands interactively via Shiny app.","code":""},{"path":"https://ccfang2.github.io/fdid/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"fdid","text":"can install development version fdid GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"ccfang2/fdid\")"},{"path":"https://ccfang2.github.io/fdid/index.html","id":"classical-event-study-plot","dir":"","previous_headings":"","what":"Classical Event Study Plot","title":"fdid","text":"hereby use event study estimates Gallagher (2014)3. following traditional event study plot displaying pointwise 95% confidence intervals.  original dataset Gdata Gallagher (2014)4, already consider potential anticipation starting event time -1, used reference time point. However, approach, suggest always using event time 0 reference time point, derive honest reference band considers potential violation -anticipation parallel trends assumption. accommodate approach, thus recenter event time 0 dataset Gdata. function fdid_scb() used compute simultaneous confidence bands using estimates event study coefficients, covariances reference time point, used honest causal inference. However, classical event study plots—one —suffer least three important limitations. First, typically display pointwise confidence intervals account multiple testing across event times. Second, particular practical importance, give impression parallel trends -anticipation assumptions can validated pre-treatment period showing insignificant pre-treatment estimates. However, classical argument ignorance failure reject null hypothesis pre-treatment effects (.e. absence differences time trends anticipatory effects) imply parallel trends -anticipation - sumptions hold. Third, equally important practical standpoint, honest inference methods—developed Rambachan Roth (2023)5—integrated standard event study plots, limiting usefulness credible causal inference. address limitations introducing functional-data perspective . key idea model underlying time-series processes continuous time—assumption already implicit many empirical studies, pointwise event-study estimates confidence intervals connected straight lines across event times. estimator builds directly standard panel-data structures pointwise identical classical panel estimator, making approach straightforward implement empirical applications. allow additional control variables staggered treatment adoption. First, Gaussian process result provides foundation constructing simultaneous confidence bands parameter (.e., event-study coefficients) across full continuum event times. Compared conventional pointwise inference, approach offers powerful credible alternative, explicitly accounting multiple-testing problem inherent event-study analyses. Second, infimum-based simultaneous confidence bands enable formal validation honest reference bands pre-treatment period via equivalence testing, allowing researchers assess plausibility parallel trends -anticipation assumptions rigorous statistical manner. Third, supremum-based simultaneous confidence bands support honest inference post-treatment period relevance testing, directly integrating existing approaches honest inference event-study framework.","code":"library(fdid) data(Gdata) Gdata$beta[,\"event_t\"] <- Gdata$beta[,\"event_t\"]- Gdata$t0 #Recenter the event time on 0  fdid_scb_est <- fdid_scb(beta=Gdata$beta, cov=Gdata$cov, t0=0) par(cex.axis = 1.4, cex.lab = 1.4, cex.main = 1.4, family=\"Times\") EventStudyPlot_Classical(fdid_scb_est, pos.legend=\"bottom\", scale.legend=1.4)"},{"path":"https://ccfang2.github.io/fdid/index.html","id":"simultaneous-confidence-bands","dir":"","previous_headings":"","what":"Simultaneous Confidence Bands","title":"fdid","text":"can therefore transform traditional event study plot rigorous honest inference tool infimum-based 90% simultaneous confidence band pre-treatment period supremum-based 95% simultaneous confidence band post-treatment period. infimum-based 90% simultaneous confidence band performing equivalence testing significance level 5% (see Section 3.3 Fang Liebl (2026)6), .e. validating honest reference band pre-anticipation period; supremum-based 95% simultaneous confidence band performing relevance testing significance level 5% (see Section 3.1 Fang Liebl (2026)7), .e. uniformly honestly testing causal inference post-treatment period. following new plot using simultaneous confidence bands.  use generic function plot() derive plot. post-treatment period, supremum-based 95% simultaneous confidence band wider classical 95% confidence intervals, pointwise intervals fail take account multiple testing. treatment effect uniformly significant simultaneous causal inference using classical reference line event time [0, 9.7]. perform validation pre-treatment period, use classical reference line simultaneous inference . estimates event study coefficients covariances, may use function fdid() estimate using original data. function allows estimation non-staggered staggered designs. particularly, consider negative weighting problem estimating event study coefficients staggered designs use carefully chosen non-negative weights sum estimates different treatment subgroups. conduct honest inference using plot , need derive honest reference band violations identification assumptions. two examples deriving honest reference band violation -anticipation parallel trends assumption respectively.","code":"par(cex.axis = 1.4, cex.lab = 1.4, cex.main = 1.4, family=\"Times\") plot(fdid_scb_est, pos.legend=\"bottom\", scale.legend=1.4, note.pre=FALSE, ci.post=TRUE)"},{"path":"https://ccfang2.github.io/fdid/index.html","id":"example-1-honest-reference-band-under-violation-of-no-anticipation-assumption","dir":"","previous_headings":"","what":"Example 1: Honest Reference Band under Violation of No-anticipation Assumption","title":"fdid","text":"now suppose , event time -2, anticipation treatment. use control parameters Su=1.4S_{u}=1.4 Sℓ=2.3S_{\\ell}=2.3 derive reference band (see equation (36) Fang Liebl (2026)8 details control parameters).  anticipation event time -2, one may see treatment effect still uniformly significant event time [0.4, 9,0]. given control parameters, reference band can validated significance level 5%, since infimum-based 90% simultaneous confidence band strictly lies within reference band pre-anticipation period (see Section 3.3 Fang Liebl (2026)9 details). result shows treatment effect Gallagher(2014)10 robust considered treatment anticipation.","code":"par(cex.axis = 1.4, cex.lab = 1.4, cex.main = 1.4, family=\"Times\") plot(fdid_scb_est, ta.ts=-2, ta.s=c(1.4,2.3), pos.legend=\"bottom\", scale.legend=1.4, ci.post=TRUE, ref.band.pre = TRUE)"},{"path":"https://ccfang2.github.io/fdid/index.html","id":"example-2-honest-reference-band-under-violation-of-parallel-trends-assumption","dir":"","previous_headings":"","what":"Example 2: Honest Reference Band under Violation of Parallel Trends Assumption","title":"fdid","text":"now suppose , differential trend. use control parameters Mu=0.25M_{u}=0.25 Mℓ=0.25M_{\\ell}=0.25 derive reference band (see equation (37) Fang Liebl (2026)11 details control parameters).  plot , although reference band validated significance level 5% due high data variability, captures visible upward pre-trend width comparable infimum-based band, providing substantive justification. Using reference band, find treatment effect still uniformly significant event time [0, 7.7]. result shows treatment effect Gallagher(2014)12 robust considered violation parallel trends assumption. cases, validating given reference band can challenging, may require selecting wide reference band—thereby making subsequent testing post-treatment period overly conservative. non-rejection equivalence null hypothesis (see Section 3.3 Fang Liebl (2026)13 details) often reflects limited sample size high variability, must viewed lack evidence null, confirmation . Thus, reference band failing pass validation can still used honest inference specification can supported domain-specific justification.","code":"par(cex.axis = 1.4, cex.lab = 1.4, cex.main = 1.4, family=\"Times\") plot(fdid_scb_est, frmtr.m=c(0.25,0.25), pos.legend=\"bottom\", scale.legend=1.4, ci.post=TRUE, ref.band.pre = TRUE)"},{"path":"https://ccfang2.github.io/fdid/index.html","id":"contact","dir":"","previous_headings":"","what":"Contact","title":"fdid","text":"Chencheng Fang, Email: ccfang[]uni-bonn.de, Hausdorff Center Mathematics; Institute Finance Statistics, University Bonn","code":""},{"path":"https://ccfang2.github.io/fdid/reference/BCVdata.html","id":null,"dir":"Reference","previous_headings":"","what":"Event study estimates from Bosch and Campos-Vazquez (2014) — BCVdata","title":"Event study estimates from Bosch and Campos-Vazquez (2014) — BCVdata","text":"Event study estimates Bosch Campos-Vazquez (2014)","code":""},{"path":"https://ccfang2.github.io/fdid/reference/BCVdata.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Event study estimates from Bosch and Campos-Vazquez (2014) — BCVdata","text":"list, containing 4 objects: beta Estimates event study coefficients. cov Estimates covariance matrix. t0 Reference period design. paper Paper indexing.","code":""},{"path":"https://ccfang2.github.io/fdid/reference/BCVdata.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Event study estimates from Bosch and Campos-Vazquez (2014) — BCVdata","text":"Bosch, M. Campos-Vazquez, R.M. (2014). Trade-Offs Welfare Policies Labor Markets Informal Jobs: Case \"Seguro Popular\" Program Mexico. American Economic Journal: Economic Policy 6(4), 71–99","code":""},{"path":"https://ccfang2.github.io/fdid/reference/CCYdata.html","id":null,"dir":"Reference","previous_headings":"","what":"Event study estimates from Chen et al. (2025) — CCYdata","title":"Event study estimates from Chen et al. (2025) — CCYdata","text":"Event study estimates Chen et al. (2025)","code":""},{"path":"https://ccfang2.github.io/fdid/reference/CCYdata.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Event study estimates from Chen et al. (2025) — CCYdata","text":"list, containing 4 objects: beta Estimates event study coefficients. cov Estimates covariance matrix. t0 Reference period design. paper Paper indexing.","code":""},{"path":"https://ccfang2.github.io/fdid/reference/CCYdata.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Event study estimates from Chen et al. (2025) — CCYdata","text":"Chen, H., Chen, Y. Yang, Q. (2025). Women courtroom: Technology Justice. Review Economic Studies, 1–28.","code":""},{"path":"https://ccfang2.github.io/fdid/reference/EventStudyPlot_Classical.html","id":null,"dir":"Reference","previous_headings":"","what":"Classical event study plot — EventStudyPlot_Classical","title":"Classical event study plot — EventStudyPlot_Classical","text":"EventStudyPlot_Classical function draw classical event study plot point-wise confidence intervals event study coefficients.","code":""},{"path":"https://ccfang2.github.io/fdid/reference/EventStudyPlot_Classical.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Classical event study plot — EventStudyPlot_Classical","text":"","code":"EventStudyPlot_Classical(object, pos.legend = \"top\", scale.legend = 1, ...)"},{"path":"https://ccfang2.github.io/fdid/reference/EventStudyPlot_Classical.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Classical event study plot — EventStudyPlot_Classical","text":"object object class \"fdid_scb\". object plotted. pos.legend character value \"top\" \"bottom\" indicates position legend. NULL, legend printed. scale.legend positive number defines size legend. pos.legend NULL, value scale.legend ignored. ... Additional arguments passed EventStudyPlot_Classical.","code":""},{"path":"https://ccfang2.github.io/fdid/reference/EventStudyPlot_Classical.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Classical event study plot — EventStudyPlot_Classical","text":"EventStudyPlot_Classical function returns classical event study plot point-wise confidence intervals event study coefficients.","code":""},{"path":"https://ccfang2.github.io/fdid/reference/EventStudyPlot_Classical.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Classical event study plot — EventStudyPlot_Classical","text":"Fang, C. Liebl, D. (2026). Making Event Study Plots Honest: Functional Data Approach Causal Inference. arXiv:2512.06804.","code":""},{"path":[]},{"path":"https://ccfang2.github.io/fdid/reference/EventStudyPlot_Classical.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Classical event study plot — EventStudyPlot_Classical","text":"","code":"data(LWdata) fdid_scb_est <- fdid_scb(beta=LWdata$beta, cov=LWdata$cov, t0=LWdata$t0)  par(cex.axis = 1.4, cex.lab = 1.4, cex.main = 1.4) EventStudyPlot_Classical(fdid_scb_est, scale.legend=1.4) title(ylab=\"Effects of Duty-to-Bargain Laws\")"},{"path":"https://ccfang2.github.io/fdid/reference/Gdata.html","id":null,"dir":"Reference","previous_headings":"","what":"Event study estimates from Gallagher (2014) — Gdata","title":"Event study estimates from Gallagher (2014) — Gdata","text":"Event study estimates Gallagher (2014)","code":""},{"path":"https://ccfang2.github.io/fdid/reference/Gdata.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Event study estimates from Gallagher (2014) — Gdata","text":"list, containing 4 objects: beta Estimates event study coefficients. cov Estimates covariance matrix. t0 Reference period design. paper Paper indexing.","code":""},{"path":"https://ccfang2.github.io/fdid/reference/Gdata.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Event study estimates from Gallagher (2014) — Gdata","text":"Gallagher, J. (2014). Learning Infrequent Event: Evidence Flood Insurance Take-United States. American Economic Journal: Applied Economics 6(3), 206–33.","code":""},{"path":"https://ccfang2.github.io/fdid/reference/LWdata.html","id":null,"dir":"Reference","previous_headings":"","what":"Event study estimates from Lovenheim and Willen (2019) — LWdata","title":"Event study estimates from Lovenheim and Willen (2019) — LWdata","text":"Event study estimates Lovenheim Willen (2019)","code":""},{"path":"https://ccfang2.github.io/fdid/reference/LWdata.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Event study estimates from Lovenheim and Willen (2019) — LWdata","text":"list, containing 4 objects: beta Estimates event study coefficients. cov Estimates covariance matrix. t0 Reference period design. paper Paper indexing.","code":""},{"path":"https://ccfang2.github.io/fdid/reference/LWdata.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Event study estimates from Lovenheim and Willen (2019) — LWdata","text":"Lovenheim, M.F. Willen, . (2019). Long-Run Effects Teacher Collective Bargaining. American Economic Journal: Economic Policy 11(3), 292– 324","code":""},{"path":"https://ccfang2.github.io/fdid/reference/Ldata.html","id":null,"dir":"Reference","previous_headings":"","what":"Event study estimates from Lafortune et al. (2018) — Ldata","title":"Event study estimates from Lafortune et al. (2018) — Ldata","text":"Event study estimates Lafortune et al. (2018)","code":""},{"path":"https://ccfang2.github.io/fdid/reference/Ldata.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Event study estimates from Lafortune et al. (2018) — Ldata","text":"list, containing 4 objects: beta Estimates event study coefficients. cov Estimates covariance matrix. t0 Reference period design. paper Paper indexing.","code":""},{"path":"https://ccfang2.github.io/fdid/reference/Ldata.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Event study estimates from Lafortune et al. (2018) — Ldata","text":"Lafortune, J., Rothstein, J. Schanzenbach, D.W. (2018). School Finance Reform Distribution Student Achievement. American Economic Journal: Applied Economics 10(2), 1–26.","code":""},{"path":"https://ccfang2.github.io/fdid/reference/cov_spline.html","id":null,"dir":"Reference","previous_headings":"","what":"Natural spline interpolation on covariance — cov_spline","title":"Natural spline interpolation on covariance — cov_spline","text":"cov_spline function used perform natural spline interpolation covariance matrix.","code":""},{"path":"https://ccfang2.github.io/fdid/reference/cov_spline.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Natural spline interpolation on covariance — cov_spline","text":"","code":"cov_spline(cov, grid, n_intrpl)"},{"path":"https://ccfang2.github.io/fdid/reference/cov_spline.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Natural spline interpolation on covariance — cov_spline","text":"cov numeric square matrix raw covariance. must contain missing values. grid numeric vector grid, raw covariance calculated. n_intrpl number points covariance interpolated. interpolation performed sequence n_intrpl equidistant points minimum maximum grid.","code":""},{"path":"https://ccfang2.github.io/fdid/reference/cov_spline.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Natural spline interpolation on covariance — cov_spline","text":"cov_spline function returns numeric matrix covariance interpolation.","code":""},{"path":"https://ccfang2.github.io/fdid/reference/cov_spline.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Natural spline interpolation on covariance — cov_spline","text":"Fang, C. Liebl, D. (2026). Making Event Study Plots Honest: Functional Data Approach Causal Inference. arXiv:2512.06804.","code":""},{"path":"https://ccfang2.github.io/fdid/reference/cov_spline.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Natural spline interpolation on covariance — cov_spline","text":"","code":"cov_mat <- cov(matrix(rnorm(250),nrow=50)) grid <- seq(0,1,len=5) cov_spline_mat <- cov_spline(cov=cov_mat, grid=grid, n_intrpl=50)"},{"path":"https://ccfang2.github.io/fdid/reference/fdid.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate the event study coefficients and the covariance matrix — fdid","title":"Estimate the event study coefficients and the covariance matrix — fdid","text":"fdid function used estimate event study coefficients covariance matrix non-staggered staggered adoption design. staggered design, estimation suffer -called negative weighting problem, since use carefully-chosen non-negative weights consolidate estimates subgroup. See Fang Liebl (2026) detailed estimation method.","code":""},{"path":"https://ccfang2.github.io/fdid/reference/fdid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate the event study coefficients and the covariance matrix — fdid","text":"","code":"fdid(data, treatment)"},{"path":"https://ccfang2.github.io/fdid/reference/fdid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate the event study coefficients and the covariance matrix — fdid","text":"data data frame first variable outcome variable, latter two variables time unit indices. outcome variable numeric. treatment data frame first variable unit index; second variable indicates reference time, treatment given, unit. NA implies unit never treated. pre-determined covariates placed afterwards. Covariates numeric.","code":""},{"path":"https://ccfang2.github.io/fdid/reference/fdid.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate the event study coefficients and the covariance matrix — fdid","text":"fdid function returns list includes estimates event study coefficients covariance. output, event time 0 considered reference period. output object S3 class \"fdid\".","code":""},{"path":"https://ccfang2.github.io/fdid/reference/fdid.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Estimate the event study coefficients and the covariance matrix — fdid","text":"Fang, C. Liebl, D. (2026). Making Event Study Plots Honest: Functional Data Approach Causal Inference. arXiv:2512.06804.","code":""},{"path":[]},{"path":"https://ccfang2.github.io/fdid/reference/fdid.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate the event study coefficients and the covariance matrix — fdid","text":"","code":"data(simulated_stagger_example) fdid_est <- fdid(data=simulated_stagger_data, treatment=simulated_stagger_treatment) plot(fdid_est$beta$coef[,2], fdid_est$beta$coef[,1], type=\"l\",      xlab=\"Event Time\", ylab=expression(hat(beta)), family=\"Times\")"},{"path":"https://ccfang2.github.io/fdid/reference/fdid_scb.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute simultaneous confidence bands for event study coefficients in functional DiD framework — fdid_scb","title":"Compute simultaneous confidence bands for event study coefficients in functional DiD framework — fdid_scb","text":"fdid_scb function used compute simultaneous confidence bands event study coefficients functional framework. Specifically, compute infimum-based simultaneous confidence band pre-treatment period parametric bootstrap, supremum-based simultaneous confidence band post-treatment period algorithm Kac-Rice formula proposed Liebl Reimherr (2023).","code":""},{"path":"https://ccfang2.github.io/fdid/reference/fdid_scb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute simultaneous confidence bands for event study coefficients in functional DiD framework — fdid_scb","text":"","code":"fdid_scb(   object = NULL,   beta = NULL,   cov = NULL,   t0 = NULL,   df = NULL,   ci.alpha = 0.05,   scb.pre.alpha = 0.05,   scb.post.alpha = 0.05 )"},{"path":"https://ccfang2.github.io/fdid/reference/fdid_scb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute simultaneous confidence bands for event study coefficients in functional DiD framework — fdid_scb","text":"object object S3 class \"fdid\", output function fdid. provided, arguments 'beta', 'cov' 't0' ignored. beta numeric matrix two columns. first column estimates event study coefficients second column corresponding event time. estimate coefficient reference time normalized 0. cov numeric matrix covariance estimates. t0 numeric scalar indicates reference time. df degree freedom t-distributed based band post-treatment periods. NULL, Gaussian distributed bands computed. ci.alpha significance level point-wise confidence intervals. scb.pre.alpha significance level infimum-based simultaneous confidence band pre-treatment periods. scb.post.alpha significance level supremum-based simultaneous confidence band post-treatment periods.","code":""},{"path":"https://ccfang2.github.io/fdid/reference/fdid_scb.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute simultaneous confidence bands for event study coefficients in functional DiD framework — fdid_scb","text":"fdid_scb function returns list containing three objects: scb list includes functional estimate event study coefficients simultaneous confidence bands. ci matrix includes point-wise estimates event study coefficients confidence intervals. data list stores original inputs beta cov. output object S3 class \"fdid_scb\".","code":""},{"path":"https://ccfang2.github.io/fdid/reference/fdid_scb.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Compute simultaneous confidence bands for event study coefficients in functional DiD framework — fdid_scb","text":"Fang, C. Liebl, D. (2026). Making Event Study Plots Honest: Functional Data Approach Causal Inference. arXiv:2512.06804. Liebl, D. M. Reimherr (2023). Fast fair simultaneous confidence bands functional parameters. Journal Royal Statistical Society Series B: Statistical Methodology 85(3), 842–868","code":""},{"path":[]},{"path":"https://ccfang2.github.io/fdid/reference/fdid_scb.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute simultaneous confidence bands for event study coefficients in functional DiD framework — fdid_scb","text":"","code":"data(LWdata) fdid_scb_est1 <- fdid_scb(beta=LWdata$beta, cov=LWdata$cov, t0=LWdata$t0)  data(simulated_stagger_example) fdid_est2 <- fdid(data=simulated_stagger_data, treatment=simulated_stagger_treatment) fdid_scb_est2 <- fdid_scb(object=fdid_est2)"},{"path":"https://ccfang2.github.io/fdid/reference/plot.fdid_scb.html","id":null,"dir":"Reference","previous_headings":"","what":"Custom plot method for objects of class ","title":"Custom plot method for objects of class ","text":"function S3 method plot, specifically designed objects class \"fdid_scb\". plots simultaneous confidence bands together honest reference band performing honest causal inference.","code":""},{"path":"https://ccfang2.github.io/fdid/reference/plot.fdid_scb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Custom plot method for objects of class ","text":"","code":"# S3 method for class 'fdid_scb' plot(   object,   ta.ts = NULL,   ta.s = NULL,   frmtr.m = NULL,   ref.band.pre = TRUE,   note.pre = TRUE,   note.post = TRUE,   ci.pre = FALSE,   ci.post = FALSE,   pos.legend = \"top\",   scale.legend = 1,   verbose = TRUE,   ... )"},{"path":"https://ccfang2.github.io/fdid/reference/plot.fdid_scb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Custom plot method for objects of class ","text":"object object class \"fdid_scb\". object plotted. ta.ts numeric value indicates time point based sample estimates treatment anticipation biases computed. less equal time point units start responding future treatment. supposed greater minimal event time greater t0 object. NULL, anticipation. ta.s numeric vector control parameters length two deriving honest reference band violation -anticipation assumption. NULL, critical value \\(t_{1-\\alpha/2, df}\\) \\(z_{1-\\alpha/2}\\) applied \\(\\alpha\\) used constructing point-wise confidence intervals. treatment anticipation defined ta.ts, value ta.s ignored. frmtr.m numeric vector control parameters length two deriving honest reference band violation parallel trends assumption. default NULL. ref.band.pre logical value. TRUE, reference band pre-anticipation period also plotted. note.pre logical value. TRUE, note pre-anticipation period given top plot. honest reference band defined, need perform validation pre-anticipation period, note.pre FALSE. note.post logical value. TRUE, note post-treatment period given top plot. ci.pre logical value. TRUE, point-wise confidence intervals pre-treatment period plotted. ci.post logical value. TRUE, point-wise confidence intervals post-treatment period plotted. pos.legend character value \"top\" \"bottom\" indicates position legend. NULL, legend printed. scale.legend positive number defines size legend. pos.legend NULL, value scale.legend ignored. verbose logical value. TRUE, uniformly significant time span(s) specification directly printed console. ... Additional arguments passed plot.","code":""},{"path":"https://ccfang2.github.io/fdid/reference/plot.fdid_scb.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Custom plot method for objects of class ","text":"function returns plot simultaneous confidence bands event study coefficients functional framework, together honest reference band honest inference, properly defined.","code":""},{"path":"https://ccfang2.github.io/fdid/reference/plot.fdid_scb.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Custom plot method for objects of class ","text":"Fang, C. Liebl, D. (2026). Making Event Study Plots Honest: Functional Data Approach Causal Inference. arXiv:2512.06804.","code":""},{"path":[]},{"path":"https://ccfang2.github.io/fdid/reference/plot.fdid_scb.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Custom plot method for objects of class ","text":"","code":"data(LWdata) fdid_scb_est <- fdid_scb(beta=LWdata$beta, cov=LWdata$cov, t0=LWdata$t0) cat(\"The reference time is \", LWdata$t0, \". If not NULL, the input 'ta.ts' in function 'plot' should be smaller than this value.\", sep=\"\") #> The reference time is -2. If not NULL, the input 'ta.ts' in function 'plot' should be smaller than this value.  ## simultaneous inference par(cex.axis = 1.4, cex.lab = 1.4, cex.main = 1.4) plot(fdid_scb_est, scale.legend=1.4) #> Uniformly and Negatively Significant Time Span: [ 0.5540188 , 1.47397 ] #> Uniformly and Negatively Significant Time Span: [ 9.661437 , 9.804583 ] #> Uniformly and Negatively Significant Time Span: [ 10.14992 , 10.39932 ] #> Uniformly and Negatively Significant Time Span: [ 11.02242 , 21 ] title(ylab=\"Effects of Duty-to-Bargain Laws\")   ## honest inference under treatment anticipation plot(fdid_scb_est, ta.ts=-3, scale.legend=1.4)  #> Uniformly and Positively Significant Time Span: [ -2 , -1.97492 ] #> Uniformly and Negatively Significant Time Span: [ 14.56289 , 18.88173 ]  ## honest inference under violation of parallel trends assumption plot(fdid_scb_est, frmtr.m=c(0.2,0.2), scale.legend=1.4)"},{"path":"https://ccfang2.github.io/fdid/reference/simulated_nonstagger_example.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulated example of non-staggered DiD design — simulated_nonstagger_example","title":"Simulated example of non-staggered DiD design — simulated_nonstagger_example","text":"Simulated example non-staggered design","code":""},{"path":"https://ccfang2.github.io/fdid/reference/simulated_nonstagger_example.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Simulated example of non-staggered DiD design — simulated_nonstagger_example","text":"contains two data frames. first data frame 'simulated_nonstagger_data' 8200 rows 5 columns: y Outcome variable. t Time index. 41 time periods. Unit index. 200 units. second data frame 'simulated_nonstagger_treatment' 200 rows 2 columns: Unit index. also corresponds unit index data frame 'simulated_nonstagger_data'. t0 Reference Period. NA indicates control units. x1, x2 Pre-determined covariates.","code":""},{"path":"https://ccfang2.github.io/fdid/reference/simulated_stagger_example.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulated example of staggered DiD design — simulated_stagger_example","title":"Simulated example of staggered DiD design — simulated_stagger_example","text":"Simulated example staggered design","code":""},{"path":"https://ccfang2.github.io/fdid/reference/simulated_stagger_example.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Simulated example of staggered DiD design — simulated_stagger_example","text":"contains two data frames. first data frame 'simulated_stagger_data' 4200 rows 5 columns: y Outcome variable. t Time index. 21 time periods. Unit index. 200 units. second data frame 'simulated_stagger_treatment' 200 rows 2 columns: Unit index. also corresponds unit index data frame 'simulated_stagger_data'. t0 Reference Period. can -0.5, 0 0.5. NA indicates control units. x1, x2 Pre-determined covariates.","code":""},{"path":"https://ccfang2.github.io/fdid/reference/tw_transf.html","id":null,"dir":"Reference","previous_headings":"","what":"Univariate two-way transformation — tw_transf","title":"Univariate two-way transformation — tw_transf","text":"tw_transf function used apply two-way transformation single variable.","code":""},{"path":"https://ccfang2.github.io/fdid/reference/tw_transf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Univariate two-way transformation — tw_transf","text":"","code":"tw_transf(x, t, i)"},{"path":"https://ccfang2.github.io/fdid/reference/tw_transf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Univariate two-way transformation — tw_transf","text":"x numeric vector two-way transformation supposed performed . t vector integers indicates time. vector indicates unit.","code":""},{"path":"https://ccfang2.github.io/fdid/reference/tw_transf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Univariate two-way transformation — tw_transf","text":"tw_transf function returns two-way transformed data reordered unit time.","code":""},{"path":"https://ccfang2.github.io/fdid/reference/tw_transf.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Univariate two-way transformation — tw_transf","text":"","code":"set.seed(100) x <- rnorm(20) t <- rep(1:5, each = 4) i <- rep(letters[1:4], times=5) df_transf <- tw_transf(x,t,i)"}]
